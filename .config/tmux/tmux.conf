set -g default-command "fish -l"
unbind C-b
set-option -g set-clipboard on
set-option -g prefix C-s
bind -n C-a copy-mode
set -g status off
set -g status-position top
set-option -g repeat-time 0
set-option -g focus-events on
set-option -g escape-time 10
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"
set-option -g synchronize-panes off
set-option -g renumber-windows on 
setw -g history-limit 1000
bind-key s choose-tree

# Automatically set window title
set-window-option -g automatic-rename off
set-option -g set-titles on

# Vi mode on
setw -g mode-keys vi
set-window-option -g mode-keys vi

# Don't exit from tmux when closing a session
set -g detach-on-destroy off 

# Enable mouse scrolling
set -g mouse on

#move pane to a new window
bind-key t break-pane 
# copy and paste like vim
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind P paste-buffer
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel

# Switch panes using leader key + hjkl in normal mode
bind-key -r 'h' select-pane -L
bind-key -r 'j' select-pane -D
bind-key -r 'k' select-pane -U
bind-key -r 'l' select-pane -R
# Switch panes using leader key + hjkl in copy mode
# bind-key -T copy-mode-vi 'h' send -X select-pane -L
# bind-key -T copy-mode-vi 'j' send -X select-pane -D
# bind-key -T copy-mode-vi 'k' send -X select-pane -U
# bind-key -T copy-mode-vi 'l' send -X select-pane -R

# Bind Tab to switch to the last active pane
bind-key Tab last-pane

# Resize panes with leader + arrow keys
bind-key -r Left resize-pane -L 5
bind-key -r Down resize-pane -D 5
bind-key -r Up resize-pane -U 5
bind-key -r Right resize-pane -R 5

# Within the command sequence, bind hjkl to swap-pane actions
bind-key -T swap-pane h swap-pane -s :.- -t :.-
bind-key -T swap-pane j swap-pane -s :.+ -t :.+
bind-key -T swap-pane k swap-pane -s :.- -t :.-
bind-key -T swap-pane l swap-pane -s :.+ -t :.+

# Swap windows 
bind-key '{' swap-window -t -1\; select-window -t -1
bind-key '}' swap-window -t +1\; select-window -t +1


# Use v and b to split a window vertically and horizontally instead of " and % respoectively
unbind '"'
unbind %
bind v split-window -h -c "#{pane_current_path}"
bind b split-window -v -c "#{pane_current_path}"

# new window but on the same path
bind C new-window -c "#{pane_current_path}"

# Use shift + arrow key to move between windows in a session
bind -n S-Left  previous-window
bind -n S-Right next-window

# Search windows
bind -n C-w display-popup -E "\
    tmux list-windows -a -F '#{window_index} #{window_name}' |\
    sed '/^$/d' |\
    fzf --reverse --header jump-to-window |\
    cut -d ' ' -f 1 |\
    xargs tmux select-window -t"

bind-key s display-popup -E -w 40% "sesh connect \"$(
 sesh list -i | gum filter --limit 1 --placeholder 'Pick a sesh' --prompt='⚡️'
)\""

# Switch to winodw number
bind-key 1 select-window -t 1
bind-key 2 select-window -t 2
bind-key 3 select-window -t 3
bind-key 4 select-window -t 4
bind-key 5 select-window -t 5
bind-key 6 select-window -t 6
bind-key 7 select-window -t 7
bind-key 8 select-window -t 8
bind-key 9 select-window -t 9

# Easier and faster switching between next/prev window
#bind C-p previous-window
#bind C-n next-window

# Use a to toggle synchronize panes
bind a set-window-option synchronize-panes

# Display lazygit
bind -r g display-popup -d '#{pane_current_path}' -w80% -h80% -E lazy

#Start window index at 1
set -g base-index 1

# Dont ask for confirmation when killing a window
bind-key x confirm-before -p "Kill pane #{pane_id}? (y/n)" kill-pane
bind-key w confirm-before -p "kill current session? (y/n)" kill-session

#pane border apearence
set-hook -g after-new-session 'setw -g pane-border-style fg=#8948ff,bg=black; setw -g pane-active-border-style fg=#8948ff,bg=black; setw -g pane-border-lines simple'

# ---- Plugin Manager
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'wfxr/tmux-power'
# set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
#
# set -g @tmux_power_theme '#8948FF'
# set -g @tmux_power_prefix_highlight_pos 'R'
# set -g @tmux_power_date_icon ' '
# set -g @tmux_power_time_icon ' '
# set -g @tmux_power_user_icon ' '
# set -g @tmux_power_session_icon ' '

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'github_username/plugin_name#branch'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
# run '~/.config/tmux/plugins/tpm/tpm'
